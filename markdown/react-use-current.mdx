<h1 className='font-semibold'>React Use Current â€” A Tiny React Hook for Synchronous Reactive State</h1>
<div className="flex flex-wrap gap-2">
  {[
    '#react',
    '#reacthooks',
    '#reactivejs',
    '#reactivity',
    '#vref',
    '#javascript',
    '#webdevelopment',
    '#opensource',
    '#frontenddev',
  ].map((tag) => (
    <span
      key={tag}
      className="font-medium"
    >
      {tag}
    </span>
  ))}
</div>

---

## ğŸš€ React Use Current â€” Reactive + Synchronous State in React

React gives us two main primitives for storing state:

### âŒ `useState`

- Reactive (re-renders UI)
- **Not synchronous** (updates batch, no immediate `.value`)
- Forces immutability
- Requires creating new references (`setState({ ... })`)

### âŒ `useRef`

- Synchronous (`ref.current = x`)
- **Not reactive** (no re-renders when changed)
- No tracking
- No deep mutation detection

### âœ”ï¸ `useCurrent` (built on **VRef**)

- **Reactive** (mutations trigger re-render)
- **Synchronous** (updated instantly like refs)
- **Mutable** (no cloning, no setState)
- **Deep tracking** (powered by VRef)
- **Fast & GC-safe** thanks to VRef

This hook gives React something it never had out-of-the-box:

> **Direct mutation that triggers re-renders â€” immediately and safely.**

---

## ğŸ” What Is React Use Current?

`react-use-current` is a tiny hook built **on top of VRef** (`vref`).  
It gives React the ability to:

- Mutate values naturally (`user.age += 1`)
- Track changes deeply
- Trigger re-renders synchronously
- Work with objects, arrays, nested data

No need for `setState()`, shallow copying, or immutable patterns.

```bash
npm install react-use-current
```

---

## ğŸ§ª Quick Example

```tsx
import useCurrent from "react-use-current";

export default function Counter() {
  const count = useCurrent(0);

  return (
    <button onClick={() => (count.value += 1)}>
      Count: {count.value}
    </button>
  );
}
```

âœ” updates instantly  
âœ” mutates directly  
âœ” re-renders correctly

---

## ğŸ§  Why Does This Hook Exist?

React developers often hit these problems:

### âŒ "I need immediate state updates"

`useState` doesn't update until next render.  
`useCurrent` updates **instantly**.

### âŒ "I want to mutate state directly (nested objects)"

`useState` forces immutability â†’ slow & annoying.  
`useCurrent` allows:

```tsx
user.address.city = "Phnom Penh";
```

### âŒ "useRef doesn't re-render when changed"

`ref.current++` won't update UI.  
`useCurrent` will.

---

## ğŸ” Comparison Table

| Feature | useState | useRef | useCurrent |
|---------|----------|--------|------------|
| Reactive | âœ”ï¸ | âŒ | âœ”ï¸ |
| Synchronous | âŒ | âœ”ï¸ | âœ”ï¸ |
| Deep mutation | âŒ | âœ”ï¸ | âœ”ï¸ |
| Triggers re-render | âœ”ï¸ | âŒ | âœ”ï¸ |
| Requires immutable updates | âœ”ï¸ | âŒ | âŒ |
| Built on VRef | âŒ | âŒ | âœ”ï¸ |

---

## ğŸ— How It Works (In Short)

- `useCurrent()` internally wraps your initial value using **VRef**'s reactive system.
- Any mutation (`obj.key = value`) triggers VRef's change event.
- `useCurrent()` listens to that event and updates an internal state token, which triggers a React re-render.
- Works deeply â€” arrays, objects, nested structures.

---

## ğŸ§© Real Example â€” Objects, Deep Mutation, and Tracking

```tsx
import { useEffect, useMemo } from "react";
import useCurrent, { track } from "react-use-current";

export default function UserCard() {
  const { value: user } = useCurrent({
    name: "John",
    age: 25,
  });

  // Run whenever user changes (deep)
  useEffect(() => {
    console.log("User mutated:", user);
  }, [track(user)]);

  // Memo recomputes when specific field changes
  const isAdult = useMemo(() => user.age >= 18, [track(user.age)]);
  // track for primitive is optional

  return (
    <div>
      <p>{user.name} â€” {user.age}</p>
      <button onClick={() => (user.age += 1)}>Increase Age</button>
      <button onClick={() => (user.name = "Doe")}>
        Change Name
      </button>
    </div>
  );
}
```

---

## ğŸ”§ Auto-Tracking Helpers

### These come from `react-use-current` (optional but powerful)

---

## ğŸŸ¦ `useApply`

**A version of `useEffect` that auto-tracks dependencies.**

```tsx
import { useApply } from "react-use-current";

useApply(() => {
  console.log("User changed:", user);
}, [user]);
```

Equivalent to:

```tsx
useEffect(() => {}, [track(user)]);
```

---

## ğŸŸ§ `useCompute`

**A version of `useMemo` that auto-tracks dependencies.**

```tsx
import { useCompute } from "react-use-current";

const isAdult = useCompute(() => {
  return user.age >= 18;
}, [user.age]);
```

Equivalent to:

```tsx
useMemo(() => ..., [track(user.age)]);
```

---

## ğŸ§¬ Understanding the `track()` Function

`track()` converts reactive values into new value that React can detect in dependency arrays.

```tsx
const updatedAt = track(user);  // reactive object
```

Tracking is required for:

- `useEffect`
- `useMemo`
- dependency change detection

This mechanism is identical to VRef's change reporters â€” but adapted for React.

---

## ğŸ“¦ Real Use Cases

### âœ” Complex forms

Directly mutate nested form fields without cloning.

### âœ” Synchronous logic (counters, timers, scrolling)

Get immediate updatesâ€”no batching.

### âœ” Local reactive stores

Like lightweight MobX-style state.

### âœ” Avoid expensive cloning in large objects

Mutate in place, but still reactive.

---

### ğŸ® Live Playground
<div align="center">
**Play with `react-use-current`:**  
ğŸ‘‰ <a href="https://stackblitz.com/edit/react-use-current?file=src/App.tsx" target='_blank'>Open Live Playground</a>
</div>

---

### ğŸ“¦ Try It

ğŸŸ¢ npm: [https://www.npmjs.com/package/react-use-current](https://www.npmjs.com/package/react-use-current)  
ğŸ™ GitHub: [https://github.com/JohnSoatra/react-use-current](https://github.com/JohnSoatra/react-use-current)  

Reference:  
ğŸŒ Docs: [https://doc.soatra.com/vref](https://doc.soatra.com/vref) (VRef base)

---

ğŸ’¬ **What do you think?**  
What do you think?  
Would this help in forms, real-time state, animations, or nested data?

---

<div align="center">
ğŸ“¬ **Contact me**
ğŸ‘‰ <a href="https://www.linkedin.com/in/soatra/" target="_blank">LinkedIn â€“ John Soatra</a>
</div>
